"use strict";(self.webpackChunkmaxi_blocks=self.webpackChunkmaxi_blocks||[]).push([[6199,4602],{6199:function(e,t,n){n.r(t);var i=n(51609),o=n(27723),l=n(47143),s=n(86087),c=n(90726),a=n(27261),r=n(8062),u=n(94602),m=n(46416),d=n(47091),p=n(47520),k=n(66087),b=n(2521),h=n(71236),f=n(2742),v=n(76856);const x=["maxi-blocks/divider-maxi","maxi-blocks/accordion-maxi","maxi-blocks/text-maxi","maxi-blocks/list-item-maxi","maxi-blocks/slider-maxi"];t.default=e=>{var t;const{blockName:n,onChange:_,linkSettings:g,clientId:C,disableCustomFormats:y=!1,"dc-status":E,"dc-link-status":A,"dc-link-target":O,"dc-type":N,"dc-field":w}=e,[L,S]=(0,s.useState)([]),{contextLoop:P}=null!==(t=(0,s.useContext)(d.WX))&&void 0!==t?t:{},{"cl-status":B,"cl-type":D}=null!=P?P:{},j=B&&p.A.includes(n),T=E||j,F=null!=N?N:D;if(x.includes(n)&&!y)return null;let R=!1;if(g?.disabled)R=!0;else{const e=(0,l.select)("core/block-editor").getClientIdsOfDescendants([C]);e?.length&&e.forEach((e=>{const t=(0,l.select)("core/block-editor").getBlockAttributes(e);(!(0,k.isEmpty)(t.linkSettings?.url)||"maxi-blocks/text-maxi"===(0,l.select)("core/block-editor").getBlockName(e)&&(t.content.includes("<a ")||t["dc-content"]?.includes("<a ")))&&(R=!0)}))}(0,s.useEffect)((()=>{A&&S((0,v.T8)(F,w))}),[F,w,A]);const W=(0,l.select)("maxiBlocks/dynamic-content").getCustomTaxonomies();return(0,i.createElement)("div",{className:"toolbar-item toolbar-item__link"},(0,i.createElement)(u.default,{icon:b.S6$,tooltip:(0,o.__)("Link","maxi-blocks"),className:(!(0,k.isNil)(g)&&!(0,k.isEmpty)(g.url)||A)&&"toolbar-item__link--active",disabled:R},!R&&(0,i.createElement)("div",{className:"toolbar-item__link-popover"},T&&(0,i.createElement)(i.Fragment,null,(0,i.createElement)(a.default,{label:(0,o.__)("Use dynamic content link","maxi-blocks"),selected:A,onChange:async t=>{const n=t&&await(0,d.eL)((0,d.o1)((0,m.XW)(e,"dynamicContent")),C);_(t?Object.assign({},g,{url:n,title:n}):Object.assign({},g,{url:null,title:null}),Object.assign({"dc-link-status":t},j&&{"dc-status":t}))}}),(h.Nt.includes(F)||h.uc.includes(w)||W.includes(w))&&A&&(0,i.createElement)(f.default,{label:(0,o.__)("Link target","maxi-blocks"),value:O,options:L,newStyle:!0,onChange:async t=>{const n=t&&await(0,d.eL)((0,d.o1)((0,m.XW)(Object.assign({},e,{"dc-link-target":t}),"dynamicContent")),C);_(Object.assign({},g,{url:n,title:n}),{"dc-link-target":t})}})),(0,i.createElement)(r.A.Consumer,null,(e=>(0,i.createElement)(c.A,{linkValue:g,isDCLinkActive:T&&A,onChangeLink:_,onRemoveLink:()=>{_({url:""}),e.onClose()}}))))))}},94602:function(e,t,n){n.r(t);var i=n(23029),o=n(92901),l=n(56822),s=n(53954),c=n(85501),a=n(64467),r=n(51609),u=n(27723),m=n(86087),d=n(56427),p=n(47143),k=n(32485),b=n.n(k),h=n(66087),f=n(26287),v=n(20436),x=n(2521),_=n(8062);function g(e,t,n){return t=(0,s.A)(t),(0,l.A)(e,C()?Reflect.construct(t,n||[],(0,s.A)(e).constructor):t.apply(e,n))}function C(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(C=function(){return!!e})()}const y=(0,f.Ay)((()=>Promise.resolve().then(n.bind(n,68145)))),E=(0,f.Ay)((()=>Promise.resolve().then(n.bind(n,98279)))),A=(0,f.Ay)((()=>Promise.resolve().then(n.bind(n,57076))));let O=function(e){function t(...e){var n;return(0,i.A)(this,t),n=g(this,t,[].concat(e)),(0,a.A)(n,"state",{isOpen:!1,onClose:()=>{n.setState({isOpen:!1})}}),n.ref=(0,m.createRef)(),n}return(0,c.A)(t,e),(0,o.A)(t,[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"onClickOutside",value:function(e){const t=e.path||e.composedPath&&e.composedPath();this.mounted&&(this.ref.current?.ownerDocument.querySelectorAll(".toolbar-item__popover").length>=2||t&&!t.includes(this.ref.current?.ownerDocument.querySelector(".toolbar-item__popover"))&&!t.includes(this.ref.current))&&this.state.onClose()}},{key:"onToggle",value:function(){const{isOpen:e}=this.state,{defaultView:t}=this.ref.current.ownerDocument;e?t.removeEventListener("click",this.onClickOutside.bind(this),!1):t.addEventListener("click",this.onClickOutside.bind(this),!1),this.setState({isOpen:!e})}},{key:"render",value:function(){const{text:e,className:t,tooltip:n,icon:i,children:o,advancedOptions:l=!1,tab:s=0,position:c="top center",disabled:a=!1}=this.props,{isOpen:m,onClose:k}=this.state,f=b()("toolbar-item","toolbar-item__button",t),{receiveMaxiSettings:g}=(0,p.select)("maxiBlocks"),{hide_tooltips:C}=g(),O=!(0,h.isEmpty)(C)&&C,N=()=>(0,r.createElement)(y,{className:f,onClick:()=>this.onToggle(),"aria-expanded":m,action:"popup",disabled:a},(0,r.createElement)(E,{className:"toolbar-item__icon",icon:i}),(0,u.__)(e,"maxi-blocks"));return(0,r.createElement)("div",{ref:this.ref},(0,r.createElement)(_.A.Provider,{value:this.state},!O&&(0,r.createElement)(d.Tooltip,{text:n,placement:"top"},N()),O&&N(),m&&o&&(0,r.createElement)(A,{anchor:this.ref?.current?.closest(".toolbar-wrapper"),className:"toolbar-item__popover",onClose:k,position:c,useAnimationFrame:!0,useFlip:!0,useShift:!0,shiftPadding:!!l&&{right:20},shiftLimit:{mainAxis:!1},isAlternate:!0,noArrow:!0},(0,r.createElement)("div",null,o),!!l&&(0,r.createElement)(y,{className:"toolbar-item__popover__advanced-button",icon:x.P2$,onClick:()=>{(0,v.z4)(s,l)}}))))}}])}(m.Component);t.default=O},8062:function(e,t,n){const i=(0,n(86087).createContext)();t.A=i}}]);