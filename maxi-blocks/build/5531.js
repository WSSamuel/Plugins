(self.webpackChunkmaxi_blocks=self.webpackChunkmaxi_blocks||[]).push([[5531],{39731:function(e,t,a){"use strict";a.r(t);var l=a(51609),o=a(27723),n=a(47143),s=a(86087),i=a(2521),c=a(87353),r=a(55590),m=a(6245),u=a(32485),_=a.n(u),d=a(38567),b=a(66087);const p=e=>{const{label:t,onClick:a,icon:o,className:n,isSelected:s}=e,i=_()("maxi-cloud-toolbar__button",n);return(0,l.createElement)("button",{className:i,onClick:a,"aria-pressed":s,type:"button"},o,(0,l.createElement)("span",null,t))};t.default=e=>{const{type:t,onChange:a,onRequestClose:u,title:_="",cost:x="",toneUrl:g,isMaxiProActive:y,isMaxiProExpired:h,isPro:E,isBeta:k,gutenbergCode:w,onInsert:v,isSwapChecked:f,onChangeTone:C,userName:N,onLogOut:B,onClickConnect:S,showNotValidEmail:$}=e,[T,L]=(0,s.useState)(!1),[I,j]=(0,s.useState)(0),F=new d.SearchClient({nodes:[{host:"24q17endjv0kacilp.a1.typesense.net",port:"443",protocol:"https"}],apiKey:"0DpJlIVm3kKOiQ9kAPTklrXrIbFLgWk6",connectionTimeoutSeconds:2});function O(e,t){for(let a=0;a<e.length;a+=1){const l=e[a];l.classList?l.classList.add(t):l.className+=` ${t}`}}function P(e,t){for(let a=0;a<e.length;a+=1){const l=e[a];l.classList?l.classList.remove(t):l.className=l.className.replace(new RegExp(`(^|\\b)${t.split(" ").join("|")}(\\b|$)`,"gi")," ")}}document.addEventListener("fullscreenchange",(e=>{document.fullscreenElement?(O(document.getElementsByClassName("maxi-cloud-toolbar"),"maxi-cloud-toolbar__fullwidth"),O(document.getElementsByClassName("maxi-cloud-toolbar__button-fullwidth"),"maxi-cloud-toolbar__button_active")):(P(document.getElementsByClassName("maxi-cloud-toolbar"),"maxi-cloud-toolbar__fullwidth"),P(document.getElementsByClassName("maxi-cloud-toolbar__button-fullwidth"),"maxi-cloud-toolbar__button_active"))}));const{getSelectedBlockClientId:R}=(0,n.select)("core/block-editor"),q=R(),M=e=>{const t=document.getElementsByClassName("maxi-library-modal__preview")[0];if(!t)return;const a=t?.getElementsByClassName("maxi-cloud-container__preview-iframe_wrap")[0],l=t?.getElementsByClassName("maxi-cloud-container")[0],o=t?.getElementsByClassName("maxi-cloud-container__preview-iframe_main-wrap")[0],n=t?.getElementsByClassName("maxi-cloud-container__preview-iframe_space")[0],s=t?.getElementsByClassName("components-modal__content")[0];if(!a)return;let i="100%",c="100%";const r=t?.getElementsByClassName("maxi-cloud-container__preview-tablet__label")[0],m=t?.getElementsByClassName("maxi-cloud-container__preview-mobile__label")[0];function u(e,t){for(let a=0;a<e.length;a+=1){const l=e[a];l.classList?l.classList.add(t):l.className+=` ${t}`}}function _(e,t){for(let a=0;a<e.length;a+=1){const l=e[a];l.classList?l.classList.remove(t):l.className=l.className.replace(new RegExp(`(^|\\b)${t.split(" ").join("|")}(\\b|$)`,"gi")," ")}}switch(e){case"t":i="768px",c="1024px",a.style.outline="#96b0cb  30px solid",a.style["border-radius"]="15px",r.style.display="block",m.style.display="none",n.style.height="20px",l.style.overflowY="scroll",a.style.margin="50px auto 35px auto",_(document.getElementsByClassName("maxi-cloud-toolbar__button-desktop"),"maxi-cloud-toolbar__button_active"),u(document.getElementsByClassName("maxi-cloud-toolbar__button-tablet"),"maxi-cloud-toolbar__button_active"),_(document.getElementsByClassName("maxi-cloud-toolbar__button-mobile"),"maxi-cloud-toolbar__button_active");break;case"m":i="390px",c="844px",a.style.outline="#96b0cb  30px solid",a.style["border-radius"]="15px",r.style.display="none",m.style.display="block",n.style.height="20px",a.style.margin="50px auto 35px auto",l.style.overflowY="scroll",_(document.getElementsByClassName("maxi-cloud-toolbar__button-desktop"),"maxi-cloud-toolbar__button_active"),_(document.getElementsByClassName("maxi-cloud-toolbar__button-tablet"),"maxi-cloud-toolbar__button_active"),u(document.getElementsByClassName("maxi-cloud-toolbar__button-mobile"),"maxi-cloud-toolbar__button_active");break;default:a.style.outline="none",a.style["border-radius"]=0,r.style.display="none",m.style.display="none",n.style.height="0px",s.style.overflowY="hidden",a.style.margin="0 auto 35px auto",l.style.overflowY="hidden",u(document.getElementsByClassName("maxi-cloud-toolbar__button-desktop"),"maxi-cloud-toolbar__button_active"),_(document.getElementsByClassName("maxi-cloud-toolbar__button-tablet"),"maxi-cloud-toolbar__button_active"),_(document.getElementsByClassName("maxi-cloud-toolbar__button-mobile"),"maxi-cloud-toolbar__button_active")}a.style.width=i,a.style.height=c,o.style.left=0,o.style.right=0},U=()=>{const e=`https://my.maxiblocks.com/login?plugin&email=${encodeURIComponent(T)}`;window.open(e,"_blank")?.focus(),S(T)};return(0,l.createElement)("div",{className:"maxi-cloud-toolbar"},"preview"!==t&&"switch-tone"!==t&&(0,l.createElement)("a",{className:"maxi-cloud-toolbar__logo"},i.Yvo,"svg"===t&&(0,o.__)("Icon library","maxi-blocks"),"patterns"===t&&(0,o.__)("Template library","maxi-blocks"),"sc"===t&&(0,o.__)("Style cards","maxi-blocks"),t.includes("shape")&&(0,o.__)("Shape library","maxi-blocks"),t.includes("button")&&(0,o.__)("Button icon library","maxi-blocks"),t.includes("video")&&(0,o.__)("Video icon library","maxi-blocks")),("preview"===t||"switch-tone"===t)&&(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{className:"maxi-cloud-toolbar__buttons-group"},(0,l.createElement)(p,{label:(0,o.__)("Back","maxi-blocks"),onClick:u}),(0,l.createElement)("h2",null,_),(0,l.createElement)("span",{className:"maxi-cloud-toolbar__line"},"|"),(0,l.createElement)("span",null,x),!(0,b.isUndefined)(g)&&!(0,b.isNil)(g)&&(0,l.createElement)(p,{onClick:()=>{(()=>{let e=g.toLowerCase();if(g.includes("/")){const t=g.replace(/:$/,"").split("/");e=t.pop()||t.pop()}const t={q:e,query_by:"post_number",per_page:1};let a=!1;document.fullscreenElement&&(a=!0),F.collections("post").documents().search(t).then((e=>{const t=e?.hits[0]?.document;window.setTimeout((()=>{if(a){const e=document.getElementsByClassName("maxi-library-modal maxi-preview")[0],t=e?.getElementsByClassName("components-modal__content")[0];t.requestFullscreen().catch((e=>{console.warn(`Error attempting to enable fullscreen mode: ${e.message} (${e.name})`)}))}}),100),C(t)}))})()},label:(0,o.__)("Switch tone","maxi-blocks")})),(0,l.createElement)("div",{className:"maxi-cloud-toolbar__responsive-buttons"},(0,l.createElement)(p,{className:"maxi-cloud-toolbar__button-fullwidth",onClick:()=>{const e=document.getElementsByClassName("maxi-library-modal maxi-library-modal__preview")[0],t=e?.getElementsByClassName("components-modal__content")[0];document.fullscreenElement?document.exitFullscreen():t.requestFullscreen().catch((e=>{console.warn(`Error attempting to enable fullscreen mode: ${e.message} (${e.name})`)}))},icon:i.iy9,label:(0,o.__)("Full screen","maxi-blocks")}),(0,l.createElement)(p,{className:"maxi-cloud-toolbar__button-desktop maxi-cloud-toolbar__button_active",onClick:()=>{M("d")},icon:i.HM$,label:(0,o.__)("Desktop","maxi-blocks")}),(0,l.createElement)(p,{className:"maxi-cloud-toolbar__button-tablet",onClick:()=>{M("t")},icon:i.TVK,label:(0,o.__)("Tablet","maxi-blocks")}),(0,l.createElement)(p,{className:"maxi-cloud-toolbar__button-mobile",onClick:()=>{M("m")},icon:i.PgH,label:(0,o.__)("Mobile","maxi-blocks")}))),"all"===t&&(0,l.createElement)("div",null,[{label:"Style Cards",value:"styleCards"},{label:"Pages",value:"pages"},{label:"Block Patterns",value:"patterns"},{label:"Global",value:"global"},{label:"Blocks",value:"blocks"},{label:"Preview",value:"preview"}].map((e=>(0,l.createElement)(p,{key:`maxi-cloud-toolbar__button__${e.value}`,label:e.label,onClick:()=>a(e.value),isSelected:t===e.value})))),"patterns"===t&&y&&N&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("h5",{className:"maxi-cloud-container__patterns__top-menu__text_pro"},(0,o.__)("Signed in: ","maxi-blocks"),(0,l.createElement)("span",{className:"maxi-username",title:I%2!=0?(0,o.__)("Click to hide","maxi-blocks"):(0,o.__)("Click to show","maxi-blocks"),onClick:e=>{j((e=>e+1))}},(0,m.B9)(N)?I%2!=0?N:"******@***.***":N)),(0,l.createElement)(r.$n,{key:"maxi-cloud-toolbar__button__sing-out",className:"maxi-cloud-container__patterns__top-menu__button-go-pro",label:(0,o.__)("Sign out","maxi-blocks"),onClick:()=>{B(!0),B()}},(0,o.__)("Sign out","maxi-blocks"))),!y&&N&&h&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("h5",{className:"maxi-cloud-container__patterns__top-menu__text_pro"},(0,o.__)("Expired: ","maxi-blocks"),(0,l.createElement)("span",{className:"maxi-username"},N)),(0,l.createElement)(r.$n,{key:"maxi-cloud-toolbar__button__connect",className:"maxi-cloud-container__patterns__top-menu__button-connect-pro",label:(0,o.__)("Sign in","maxi-blocks"),onClick:()=>U()},(0,o.__)("Sign in","maxi-blocks"))),!y&&N&&!h&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("h5",{className:"maxi-cloud-container__patterns__top-menu__text_pro"},(0,l.createElement)("span",{className:"maxi-username"},N)),(0,l.createElement)(r.$n,{key:"maxi-cloud-toolbar__button__sing-out",className:"maxi-cloud-container__patterns__top-menu__button-go-pro",label:(0,o.__)("Sign out","maxi-blocks"),onClick:B},(0,o.__)("Sign out","maxi-blocks"))),"patterns"===t&&!y&&!N&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__sign-in"},(0,l.createElement)("div",{className:"maxi-cloud-container__patterns__top-menu__input"},(0,l.createElement)(r.xt,{placeholder:(0,o.__)("Pro user email","maxi-blocks"),value:T,onChange:e=>L(e)}),$&&(0,l.createElement)("span",null,(0,o.__)("The email is not valid","maxi-blocks"))),(0,l.createElement)(r.$n,{key:"maxi-cloud-toolbar__button__connect",className:"maxi-cloud-container__patterns__top-menu__button-connect-pro",label:(0,o.__)("Sign in","maxi-blocks"),onClick:()=>U()},(0,o.__)("Sign in","maxi-blocks"))),"preview"!==t&&"switch-tone"!==t&&(0,l.createElement)("a",{href:"https://maxiblocks.com/go/help-center",target:"_blank",rel:"noopener noreferrer",className:"maxi-cloud-toolbar__help-button"},i.yjE,(0,o.__)("Help","maxi-blocks")),("preview"===t||"switch-tone"===t)&&(0,l.createElement)("div",{className:"maxi-cloud-toolbar__buttons-group_close"},(!E||k||y&&N)&&(0,l.createElement)(p,{label:(0,o.__)("Insert","maxi-blocks"),onClick:async()=>{v(),await(0,c.A)(w,f,q)}}),(0,l.createElement)(p,{onClick:u,icon:i.utg})))}},87353:function(e,t,a){"use strict";a.d(t,{A:function(){return m}});var l=a(27723),o=a(74997),n=a(47143),s=a(16480),i=a(66087);const c=async()=>{try{const{getEntityRecords:e}=(0,n.resolveSelect)("core"),t=await e("postType","attachment",{post_status:"inherit",posts_per_page:1,search:"maxi-pattern-placeholder"});if(!(0,i.isEmpty)(t))return{id:t[0].id,url:t[0].media_details.sizes.full.source_url};const{placeholder_url:a}=await(0,n.resolveSelect)("maxiBlocks").receiveMaxiSettings(),o=await fetch(a).then((e=>e.blob())).catch((e=>(console.warn((0,l.__)(`The Cloud server is down, using the placeholder image. Error: ${e}`,"maxi-blocks")),!1)));let c=!1;const r=(await e("taxonomy","maxi-image-type"))[0].id;await(0,s.uploadMedia)({filesList:[new File([o],"maxi-pattern-placeholder.jpg",{type:"image/jpeg"})],onFileChange:e=>{[c]=e},onError:e=>console.warn((0,l.__)(`Can't upload the placeholder image, check directory's permissions. Error: ${e}`,"maxi-blocks"))});const m=""===c?.comment_status?"closed":c?.comment_status;return(0,n.dispatch)("core").saveEntityRecord("postType","attachment",Object.assign({},c,{"maxi-image-type":r,comment_status:m}),{throwOnError:!0}),c}catch(e){console.error((0,l.__)(`Error uploading the placeholder image: ${e}`,"maxi-blocks"))}return null};const r=async(e,t)=>{const{replaceBlock:a}=(0,n.dispatch)("core/block-editor");a(t,(0,o.rawHandler)({HTML:e,mode:"BLOCKS"}))};var m=async(e,t,a)=>{if(await(0,n.resolveSelect)("core/block-editor").isValidTemplate(e)){const o=[],m=[],u=/(mediaID|imageID)":(.*)",/g,_=e.match(u);if(_?.forEach((e=>{const t=e.replace(/\\/g,""),a=t?.match(/(mediaID|imageID)":(\d+),/g)?.map((e=>e.match(/\d+/)[0]));(0,i.isEmpty)(a)||m.push.apply(m,a);const l=t?.match(/(mediaURL|imageURL)":"([^"]+)"/g)?.map((e=>e.split(/:(.+)/,2)[1].replace(/"/g,"")));(0,i.isEmpty)(l)||o.push.apply(o,l)})),(0,i.isEmpty)(o)||(0,i.isEmpty)(m))r(e,a);else{let u=e;const _=(0,i.uniq)(o),d=(0,i.uniq)(m);if(_.length!==d.length)return console.error((0,l.__)("Error processing images' links and ids - counts do not match","maxi-blocks")),void r(e,a);const b=d.reduce(((e,t,a)=>Object.assign({},e,{[t]:_[a]})),{});let p=t?await c():null;(await Promise.all(Object.entries(b).map((async([e,a])=>(p=t?p:await(async(e,t)=>{if(t)return c();const{getEntityRecords:a}=(0,n.resolveSelect)("core"),{title:o,fileName:r,mimeType:m}=(e=>{const t=e.substring(e.lastIndexOf("/")+1),a=t.split(".").pop(),l={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif",webp:"image/webp"}[a.toLowerCase()];return{title:t.replace(`.${a}`,""),fileName:t,mimeType:l}})(e),u=await a("postType","attachment",{post_status:"inherit",search:o,exact:!0});if(!(0,i.isEmpty)(u)){var _;let e;if(0===u.length)return c();if(1===u.length)[e]=u;else{const t=u.findIndex((({title:{raw:e}})=>e===o||e===`${o}-1`));if(-1===t)return c();e=u[t]}return{id:e.id,url:null!==(_=e?.media_details?.sizes?.full?.source_url)&&void 0!==_?_:e.guid.rendered}}const d=await fetch(e).then((e=>e.blob())).catch((e=>(console.warn((0,l.__)(`The Cloud server is down, using the placeholder image. Error: ${e}`,"maxi-blocks")),!1)));if(!d)return c();let b=!1;const p=(await a("taxonomy","maxi-image-type"))[0].id;await(0,s.uploadMedia)({filesList:[new File([d],r,{type:m})],onFileChange:e=>{[b]=e},onError:e=>console.warn((0,l.__)(`The original image not found (404) on the Cloud Site, using the placeholder image. Error: ${e.code}, ${e.message}`,"maxi-blocks"))});const x=""===b.comment_status?"closed":b.comment_status;return(0,n.dispatch)("core").saveEntityRecord("postType","attachment",Object.assign({},b,{"maxi-image-type":p,comment_status:x}),{throwOnError:!0}),b})(a,t),{id:p?.id,oldId:e,url:p?.url,oldUrl:a}))))).forEach((({id:e,oldId:t,url:a,oldUrl:l})=>{u=u.replaceAll(l,a),u=u.replaceAll(t,e)})),await r(u,a)}}else console.error((0,l.__)("The Code is not valid","maxi-blocks"))}},73529:function(){}}]);